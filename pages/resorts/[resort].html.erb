<%
  # Generate forecast summary
  total_snow = total_snow_for(resort)
  forecast_summary = if total_snow > 0
    "Expecting #{format_snow_total_plain(total_snow)} of snow in the forecast period."
  else
    "No significant snowfall expected in the current forecast period."
  end

  # Get the next snow day if available
  next_snow_day = raw_forecasts_for(resort).find { |f| snow_inches(f) > 0 }
  if next_snow_day
    forecast_summary += " Next snow: #{next_snow_day.name}."
  end
%>
<!--
  ---
  title: 'Weekly forecast of snow for <%= h resort.name %>'
  description: '<%= h resort.name %> in <%= h resort.region_name %>, <%= h resort.country_name %>. <%= forecast_summary %>'
  page_url: '/resorts/<%= resort.name.parameterize %>'
  ---
-->

<div class="text-sm breadcrumbs mb-4">
  <ul>
    <li><a href="/">All</a></li>

    <li>
      <a href="/countries/<%= resort.country_name.parameterize %>">
        <%= h resort.country_name %>
      </a>
    </li>

    <li>
      <a href="/states/<%= resort.region_name.parameterize %>">
        <%= h resort.region_name %>
      </a>
    </li>

    <li>
      <% if resort.url %>
        <a href="<%= resort.url %>"><%= h resort.name %></a>
      <% else %>
        <%= h resort.name %>
      <% end %>
    </li>
  </ul>
</div>

<h2 class="text-3xl font-bold mb-4">Long Term Forecast</h2>

<% headers, rows=table_for_longterm(resort) %>

<div class="overflow-x-auto">
  <table class="table w-full sticky">
    <!-- Table header -->
    <thead>
      <tr>
        <% headers.each do |header| %>
          <th><%= h header %></th>
        <% end %>
      </tr>
    </thead>

    <tbody>
      <% rows.each do |row| %>
        <tr>
          <% row.each_with_index do |cell, index| %>
            <% if index == 1 && snow?(cell) %>
              <!-- Snowfall column (index 1) - highlight if there's snow -->
              <td class="snow-cell">
                <span class="snow-value"><%= h cell %>❄️</span>
              </td>
            <% elsif index == 1 %>
              <!-- Snowfall column with no snow -->
              <td class="text-gray-400"><%= h cell %></td>
            <% else %>
              <!-- Other columns -->
              <td><%= h cell %></td>
            <% end %>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
