(()=>{(function(){var o=document.getElementById("unit-toggle");function m(){var s=o.checked;s?document.body.classList.add("metric"):document.body.classList.remove("metric")}o.addEventListener("change",()=>{m(),localStorage.setItem("preferredUnits",o.checked?"metric":"imperial")}),window.addEventListener("DOMContentLoaded",s=>{let c=navigator.language||navigator.userLanguage,t=localStorage.getItem("preferredUnits");t?(console.log("preferred units",t),o.checked=t==="metric"):c==="en-US"?o.checked=!1:o.checked=!0,m();let a=document.getElementById("filter-snow-toggle");if(a){let n=localStorage.getItem("filterSnowOnly")==="true";a.checked=n,n&&document.body.classList.add("filter-snow-only"),a.addEventListener("change",()=>{let e=a.checked;e?document.body.classList.add("filter-snow-only"):document.body.classList.remove("filter-snow-only"),localStorage.setItem("filterSnowOnly",e)})}});let r=null,u=!1,f=document.getElementById("search-modal"),y=document.getElementById("search-button"),l=document.getElementById("search-input"),d=document.getElementById("search-results"),h=document.getElementById("search-loading"),i=document.getElementById("search-empty");async function g(){if(!(r||u)){u=!0,h.classList.remove("hidden");try{let c=await(await fetch("/assets/search-data.json")).json();r=c.d.map(t=>({type:t.t==="c"?"country":t.t==="s"?"state":"resort",name:t.n,country:typeof t.c=="number"?c.cl[t.c]:void 0,state:t.s,url:t.u}))}catch(s){console.error("Failed to load search data:",s),r=[]}finally{u=!1,h.classList.add("hidden")}}}function p(s){if(!r)return;let c=s.toLowerCase().trim();if(!c){d.innerHTML="",i.classList.add("hidden");return}let t=r.filter(e=>{let b=e.name.toLowerCase().includes(c),w=e.country&&e.country.toLowerCase().includes(c),E=e.state&&e.state.toLowerCase().includes(c);return b||w||E}).slice(0,50);if(t.length===0){d.innerHTML="",i.classList.remove("hidden");return}i.classList.add("hidden");let a={country:t.filter(e=>e.type==="country"),state:t.filter(e=>e.type==="state"),resort:t.filter(e=>e.type==="resort")},n="";a.country.length>0&&(n+='<div class="mb-4"><h4 class="font-semibold text-sm mb-2 text-base-content/60">Countries</h4><ul class="menu">',a.country.forEach(e=>{n+=`<li><a href="${e.url}" class="flex items-center gap-2"><span>\u{1F30D}</span><span>${e.name}</span></a></li>`}),n+="</ul></div>"),a.state.length>0&&(n+='<div class="mb-4"><h4 class="font-semibold text-sm mb-2 text-base-content/60">States / Regions</h4><ul class="menu">',a.state.forEach(e=>{n+=`<li><a href="${e.url}" class="flex items-center gap-2"><span>\u{1F4CD}</span><span>${e.name}</span><span class="text-xs text-base-content/60">${e.country}</span></a></li>`}),n+="</ul></div>"),a.resort.length>0&&(n+='<div class="mb-4"><h4 class="font-semibold text-sm mb-2 text-base-content/60">Ski Resorts</h4><ul class="menu">',a.resort.forEach(e=>{n+=`<li><a href="${e.url}" class="flex items-center gap-2"><span>\u26F7\uFE0F</span><div class="flex flex-col items-start"><span>${e.name}</span><span class="text-xs text-base-content/60">${e.state}, ${e.country}</span></div></a></li>`}),n+="</ul></div>"),d.innerHTML=n}function L(s,c){let t;return function(...n){let e=()=>{clearTimeout(t),s(...n)};clearTimeout(t),t=setTimeout(e,c)}}let v=L(p,300);y.addEventListener("click",()=>{f.showModal(),g(),l.focus()}),l.addEventListener("input",s=>{v(s.target.value)}),f.addEventListener("close",()=>{l.value="",d.innerHTML="",i.classList.add("hidden")}),document.addEventListener("keydown",s=>{(s.metaKey||s.ctrlKey)&&s.key==="k"&&(s.preventDefault(),f.showModal(),g(),l.focus())})})();})();
