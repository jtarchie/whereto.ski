(function(){var o=document.getElementById("unit-toggle");function f(){var t=o.checked;t?document.body.classList.add("metric"):document.body.classList.remove("metric")}o.addEventListener("change",()=>{f(),localStorage.setItem("preferredUnits",o.checked?"metric":"imperial")}),window.addEventListener("DOMContentLoaded",t=>{const s=navigator.language||navigator.userLanguage,c=localStorage.getItem("preferredUnits");c?(console.log("preferred units",c),o.checked=c==="metric"):s==="en-US"?o.checked=!1:o.checked=!0,f();const a=document.getElementById("filter-snow-toggle");if(a){const n=localStorage.getItem("filterSnowOnly")==="true";a.checked=n,n&&document.body.classList.add("filter-snow-only"),a.addEventListener("change",()=>{const e=a.checked;e?document.body.classList.add("filter-snow-only"):document.body.classList.remove("filter-snow-only"),localStorage.setItem("filterSnowOnly",e)})}});let l=null,u=!1;const m=document.getElementById("search-modal"),g=document.getElementById("search-button"),r=document.getElementById("search-input"),d=document.getElementById("search-results"),h=document.getElementById("search-loading"),i=document.getElementById("search-empty");async function y(){if(!(l||u)){u=!0,h.classList.remove("hidden");try{const t=await(await fetch("/assets/search-data.json")).json();l=t.d.map(s=>({type:s.t==="c"?"country":s.t==="s"?"state":"resort",name:s.n,country:typeof s.c=="number"?t.cl[s.c]:void 0,state:s.s,url:s.u}))}catch(t){console.error("Failed to load search data:",t),l=[]}finally{u=!1,h.classList.add("hidden")}}}function p(t){if(!l)return;const s=t.toLowerCase().trim();if(!s){d.innerHTML="",i.classList.add("hidden");return}const c=l.filter(e=>{const b=e.name.toLowerCase().includes(s),E=e.country&&e.country.toLowerCase().includes(s),w=e.state&&e.state.toLowerCase().includes(s);return b||E||w}).slice(0,50);if(c.length===0){d.innerHTML="",i.classList.remove("hidden");return}i.classList.add("hidden");const a={country:c.filter(e=>e.type==="country"),state:c.filter(e=>e.type==="state"),resort:c.filter(e=>e.type==="resort")};let n="";a.country.length>0&&(n+='<div class="mb-4"><h4 class="font-semibold text-sm mb-2 text-base-content/60">Countries</h4><ul class="menu">',a.country.forEach(e=>{n+=`<li><a href="${e.url}" class="flex items-center gap-2"><span>\u{1F30D}</span><span>${e.name}</span></a></li>`}),n+="</ul></div>"),a.state.length>0&&(n+='<div class="mb-4"><h4 class="font-semibold text-sm mb-2 text-base-content/60">States / Regions</h4><ul class="menu">',a.state.forEach(e=>{n+=`<li><a href="${e.url}" class="flex items-center gap-2"><span>\u{1F4CD}</span><span>${e.name}</span><span class="text-xs text-base-content/60">${e.country}</span></a></li>`}),n+="</ul></div>"),a.resort.length>0&&(n+='<div class="mb-4"><h4 class="font-semibold text-sm mb-2 text-base-content/60">Ski Resorts</h4><ul class="menu">',a.resort.forEach(e=>{n+=`<li><a href="${e.url}" class="flex items-center gap-2"><span>\u26F7\uFE0F</span><div class="flex flex-col items-start"><span>${e.name}</span><span class="text-xs text-base-content/60">${e.state}, ${e.country}</span></div></a></li>`}),n+="</ul></div>"),d.innerHTML=n}function L(t,s){let c;return function(...a){const n=()=>{clearTimeout(c),t(...a)};clearTimeout(c),c=setTimeout(n,s)}}const v=L(p,300);g.addEventListener("click",()=>{m.showModal(),y(),r.focus()}),r.addEventListener("input",t=>{v(t.target.value)}),m.addEventListener("close",()=>{r.value="",d.innerHTML="",i.classList.add("hidden")}),document.addEventListener("keydown",t=>{(t.metaKey||t.ctrlKey)&&t.key==="k"&&(t.preventDefault(),m.showModal(),y(),r.focus())})})();
